language: java
os: linux
arch:
#  - arm64
#  - s390x
  - ppc64le
jdk:
  openjdk11
script: ./gradlew verifyPlugin test

jobs:
  include:
    - stage: test
    - stage: SonarCloud
      if: branch = master OR branch =~ ^release\/.*$ OR branch =~ ^sonar\/.*$
      script: ./gradlew jacocoTestReport sonar --debug
git:
  depth: false

before_cache:
  - rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/
  - rm -fr $HOME/.gradle/caches/modules-2/files-*/com.jetbrains.intellij.idea/
  - rm -fr $HOME/.gradle/caches/modules-2/metadata-*/descriptors/com.jetbrains.intellij.idea/
cache:
  timeout: 900
  directories:
    - $HOME/.gradle/caches/
    - $HOME/.gradle/wrapper/
#addons:
#  sonarcloud:
#    organization: "mcmics-github"
#    token:
#      secure: "KbnVHVBBFomQohD9bWjDd2828fZeew82/GwSQo1+GmEa6Heekjp0E/RGs9gf+FaOLIG6UDXfnunZflJBoWHr+h0auEro2DXcMRyKmF8eEjmJCRDWNF5ltRFVCIceFVAwnHK2IN/YhTHi+GdW8YIwAF+QZJWdds1RUckuXsDBNx62l/NvrtlYpnbp3jiQ4bZQojrW7Vh7NLxPkOskLFB8nBrP3yWNhnX5lfHc2K1KMFjQYryLB6RXsmCu1nha1XWxEqS9WV5VzumF3P1LCStly/6rSsfYrGzrpmLUQwwW4lXmNGi3BMWrZbN4NEmwhckXEXeNZpbUJWCnCpv2rkUkK1UCaeYkvSqgW4KSgLmbI7uPri41r/U9PMyETN/GrZBjFSQGiIorpitVPh0tG+nEzvOMQBDIX9ovF30tdM7R3uIctVRUyu63bJIaUlUpjP63k2YI4GWDT2bjUFr2HYeTIvT5LWp79ydKJ7DTbhZyeZx/84uZo7J4GjrytwFkYa4OWAER0pRFVwSJZYTls9YVD2Ky6IK6uIeAvZDmt0IoVGTICw1TiKTnfyYpUZ6bT7qDnyoQWLf45AIOTXFISZBJLzRxGnP/kUVhDc/hUhlxbVeOVZaGANPYuU7rUuTnH+w7pL4C3ydhLwX33FZYlqyF1BEiWpJu74UtRi1vxb0X1iw="
